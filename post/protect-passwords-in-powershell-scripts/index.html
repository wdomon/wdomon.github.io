<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='In light of the recent news that Uber was hacked largely in part due to a highly privileged credentials being stored in a Powershell script in plain text, I figured some admins writing Powershell might be scrambling to finally level up their secret game. There are lots of ways to store your credentials for Powershell scripts (and effectively all of them are better than plain text); each with their own list of pros and cons, but I&amp;rsquo;ll share one way that provides a layered approach to protecting the secrets while also the flexibility to use those secrets on-prem or in the cloud.'><title>Protect Passwords in Powershell Scripts</title>
<link rel=canonical href=https://adminbraindump.com/post/protect-passwords-in-powershell-scripts/><link rel=stylesheet href=/scss/style.min.ac77dcf8b111b51da39a92990f431923f210f3876d85798a2125667f96dc33a4.css><meta property='og:title' content='Protect Passwords in Powershell Scripts'><meta property='og:description' content='In light of the recent news that Uber was hacked largely in part due to a highly privileged credentials being stored in a Powershell script in plain text, I figured some admins writing Powershell might be scrambling to finally level up their secret game. There are lots of ways to store your credentials for Powershell scripts (and effectively all of them are better than plain text); each with their own list of pros and cons, but I&amp;rsquo;ll share one way that provides a layered approach to protecting the secrets while also the flexibility to use those secrets on-prem or in the cloud.'><meta property='og:url' content='https://adminbraindump.com/post/protect-passwords-in-powershell-scripts/'><meta property='og:site_name' content='Admin Brain Dump'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Security'><meta property='article:published_time' content='2022-09-17T08:51:50-07:00'><meta property='article:modified_time' content='2022-11-03T08:12:00-07:00'><meta name=twitter:title content="Protect Passwords in Powershell Scripts"><meta name=twitter:description content="In light of the recent news that Uber was hacked largely in part due to a highly privileged credentials being stored in a Powershell script in plain text, I figured some admins writing Powershell might be scrambling to finally level up their secret game. There are lots of ways to store your credentials for Powershell scripts (and effectively all of them are better than plain text); each with their own list of pros and cons, but I&amp;rsquo;ll share one way that provides a layered approach to protecting the secrets while also the flexibility to use those secrets on-prem or in the cloud."><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-239997350-1","auto"),ga("send","pageview"))</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NBJPVX4KDE"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NBJPVX4KDE")</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"dark")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/brain_logo_hu89663f246778269acddeb777ee15915c_13368_300x0_resize_box_3.png width=300 height=326 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ðŸ’©</span></figure><div class=site-meta><h1 class=site-name><a href=/>Admin Brain Dump</a></h1><h2 class=site-description>A mostly organized brain dump</h2></div></header><ol class=social-menu><li><a href=https://github.com/wdomon target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://adminbraindump.com/ selected></option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/protect-passwords-in-powershell-scripts/>Protect Passwords in Powershell Scripts</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 17, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>In light of the recent news that <a class=link href=https://arstechnica.com/information-technology/2022/09/uber-was-hacked-to-its-core-purportedly-by-an-18-year-old-here-are-the-basics/ target=_blank rel=noopener>Uber was hacked</a> largely in part due to a highly privileged credentials being stored in a Powershell script in plain text, I figured some admins writing Powershell might be scrambling to finally level up their secret game. There are lots of ways to store your credentials for Powershell scripts (and effectively <em>all</em> of them are better than plain text); each with their own list of pros and cons, but I&rsquo;ll share one way that provides a layered approach to protecting the secrets while also the flexibility to use those secrets on-prem or in the cloud.</p><h3 id=prerequisites>Prerequisites</h3><ul><li><a class=link href="https://learn.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-8.3.0" target=_blank rel=noopener>Azure Az Powershell Module</a></li><li>Azure subscription</li><li>Access to create Azure KeyVault and grant access controls to it</li><li>Access to create AzureAD Service Principals (App registration)</li></ul><h3 id=store-the-actual-secrets-in-azure-keyvault>Store the actual secrets in Azure KeyVault</h3><p>The actual usernames/passwords needed by the script to perform operations will be stored in Azure KeyVault. This allows for granular/RBAC permissions to be granted to secrets within Azure as well as a way to separate the credentials so scripts do not have access to more than they need. Anytime you are creating a new workload, function, group of tasks, etc. I recommend to put them in their own resource group. This helps organize things but also helps with applying specific Azure Policy to specific resources. In this example, I create a new resource group and then a new KeyVault to be used for these secrets.</p><p><img src=/post/protect-passwords-in-powershell-scripts/create-rg-and-kv.png width=1470 height=538 srcset="/post/protect-passwords-in-powershell-scripts/create-rg-and-kv_hufc18eb5fc311b9ab3facb498ceb037c4_69556_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/create-rg-and-kv_hufc18eb5fc311b9ab3facb498ceb037c4_69556_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=273 data-flex-basis=655px></p><h3 id=create-a-service-principal>Create a Service Principal</h3><p>Now that the KeyVault exists we need to limit who can access the secrets inside. For this we will be creating a service principal by way of an Azure App registration. The naming convention you use for app registrations may vary, the important part here is to differentiate between scripts as each script/task will have it&rsquo;s own Service Principal. Doing so ensures that each script has it&rsquo;s own individual authentication mechanism so logs will clearly indicate which process was authenticating. At this point, you may be thinking that it would be convenient to have one KeyVault with all of your credentials in it and then limit Service Principals to only being able to read the credentials they need. Sadly, Microsoft does not provide a way to set permissison on individaul keys or secrets within a KeyVault; only to the KeyVault itself. As a result, we create a separate KeyVault for each script (though we can keep them all in one Resource Group). We do this so if somehow the service principal was ever compromised that it does not hold the keys to the kingdom, only to the couple of secrets it needs to run and only the ability to read that secret, not modify/delete. Does this make it a pain when we rotate/change passwords? Absolutely, but doing things the &ldquo;right&rdquo; way is typically a pain when compared to the alternative.</p><p>Create a new Service Principal and note the <code>AppId</code> output. Then, create a new KeyVault Access Policy that grants &ldquo;get&rdquo; permissions for secrets in the desired KeyVault using the aforementioned <code>AppId</code> value for the <code>ServicePrincipalName</code> parameter. This value can also be found for existing Service Principals by looking at the <code>AppId</code> or <code>ServicePrincipalName</code> attributes of that object using <code>Get-AzADServicePrincipal</code> cmdlet.</p><p><img src=/post/protect-passwords-in-powershell-scripts/create-serviceprincipal-and-accesspolicy.png width=1477 height=254 srcset="/post/protect-passwords-in-powershell-scripts/create-serviceprincipal-and-accesspolicy_hu06aa05941cd97dce5380dd226ab290a0_33181_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/create-serviceprincipal-and-accesspolicy_hu06aa05941cd97dce5380dd226ab290a0_33181_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=581 data-flex-basis=1395px></p><h3 id=create-a-client-secret>Create a Client Secret</h3><p>The Service Principal now has access to the KeyVault, however we still need a way to use (authenticate as) the Service Principal. Azure automatically creates a Client Secret when you create a new Service Principal. However, when you create it via Powershell you are not presented with what that Client Secret is, and by design you can never recover it again. As a result, I make it a habit to just delete the one Azure creates immediately after I create a Service Principal and create a new one. Because Client Secrets cannot be accessed ever again once they&rsquo;re created, it&rsquo;s important that you account for this when building a new one. As you can see in the example below if you just create a new Secret the <code>SecretText</code> attribute can actually be truncated in your Powershell console and you will not be able to get the full value ever again. As a result, if you are building this interactively be sure to either encase the command in parenthesis and call the <code>SecretText</code> attribute, or use <code>Select-Object</code> to expand the property (my preference).</p><p><img src=/post/protect-passwords-in-powershell-scripts/secret-text-attribute.png width=1508 height=375 srcset="/post/protect-passwords-in-powershell-scripts/secret-text-attribute_hua0db312c5edc115361bbeb52cc62fb2f_64407_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/secret-text-attribute_hua0db312c5edc115361bbeb52cc62fb2f_64407_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=402 data-flex-basis=965px></p><h3 id=connection-in-powershell-script>Connection in Powershell Script</h3><p>Now all that is left is to tell our Powershell script to authenticate into the Azure tenant AS that Service Principal and then access the Secret in that KeyVault. The first step for this is to obtain the Tenant ID if you don&rsquo;t already have it. The easiest way to do this is when connected to Azure via Powershell just run <code>(Get-AzContext).tenant.id</code> and it will return the ID you need. Once you have this, you connect using the method below by using your Service Principal Name (aka <code>AppId</code>, or <code>ClientID</code>) and the Client Secret. The first line shows that I am not connected to the tenant and the last line shows the that I was able to output the secret in plain text after authenticating as the Service Principal.</p><p><img src=/post/protect-passwords-in-powershell-scripts/connect-sp-output-secret.png width=1508 height=498 srcset="/post/protect-passwords-in-powershell-scripts/connect-sp-output-secret_hub2e5de5f5f6b043cfc705cea0e393171_97671_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/connect-sp-output-secret_hub2e5de5f5f6b043cfc705cea0e393171_97671_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=302 data-flex-basis=726px></p><h3 id=whats-the-difference>What&rsquo;s the difference?</h3><p>Great, so we now have the ability to let our Powershell scripts authenticate to Azure KeyVault to obtain passwords and secrets. But as many people tend to point out at this stage, aren&rsquo;t we just putting the &ldquo;Client Secret&rdquo; in plain text in the script? And isn&rsquo;t that basically just a password as well? Yes and yes. While keeping the password itself out of plain text and in Azure KeyVault instead is definitely more secure, it&rsquo;s just a small hurdle for an attacker to jump through to get the password. The second step here is what helps lock this down in a much more secure way: Encrypting the client secret in a local file on the server running the Powershell script. This is done by leveraging the Data Protection API (DPAPI) built into the Windows Server OS. When this API is used to encrypt a file there are two key requirements that must be met to decrypt the file that we take advantage of:</p><ol><li>The decryption request must come from the user account that was used to originally encrypt it.</li><li>The decryption request must come from the Windows Server OS that was used to originally encrypt it.</li></ol><p>This means that if an attacker were able identify that this file holds the Client Secret (let&rsquo;s say by locating the Powershell script and seeing a connection string like in the case of Uber&rsquo;s hack), they could not decrypt the file unless they were logged into the server that originally encrypted the file and ALSO logged in as the user that originally encrypted the file. The catch here is that you must run the scheduled task that is launching the script as the same user that you use to generate the encrypted file; for this use a service account that has no permissions to anything on the network other than the file path it writes this encrypted file to and the location of the script the scheduled task is running.</p><h3 id=encrypting-the-local-file>Encrypting the local file</h3><p>Encrypting data in a local file is quite easy and only takes a couple of lines. First we take the variable we used earlier that is just a plain text string containing the Client Secret; we convert it TO a secure string and then back FROM a secure string and dump that to a text file.</p><p><img src=/post/protect-passwords-in-powershell-scripts/encrypting-data-to-file.png width=1508 height=109 srcset="/post/protect-passwords-in-powershell-scripts/encrypting-data-to-file_hu58f334bd0f001825cd071487ffb58d42_13665_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/encrypting-data-to-file_hu58f334bd0f001825cd071487ffb58d42_13665_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=1383 data-flex-basis=3320px></p><h3 id=usingdecrypting-the-local-file>Using/decrypting the local file</h3><p>Rather than go into detail as to how this works, there is a <a class=link href=https://www.pdq.com/blog/secure-password-with-powershell-encrypting-credentials-part-1/ target=_blank rel=noopener>quick writeup from the folks at PDQ on this topic specifically</a> that you can read if you&rsquo;re interested. Once the file exists, that is it! It is encrypted by the Windows DP API and decrypting it in scripts (that run as the same user account that encrypted it) is as easy as just <code>Get-Content -Path &lt;path to file> | ConvertTo-SecureString</code>. As you can see below, if you read the contents of the text file it is just a long string of alphanumeric characters. To make it usable in a script, you just create a credential object using the ClientID and the decrypted Client Secret and use that when connecting to Azure as the Service Principal!</p><p>As the warning in the below screenshot mentions, Microsoft has a pretty idiotic default setting in the <code>Connect-AzAccount</code> cmdlet in that it saves the secret being used to connect as a service principal&mldr; IN PLAIN TEXT&mldr; in a text file for &ldquo;convenience.&rdquo; I could go on a tirade about why this shouldn&rsquo;t even exist as an option in this first party cmdlet, but to have it function this way by default is abhorrent. Nonetheless, be sure to run <code>Disable-AzContextAutosave</code> as the service account you use to run the scripts and decrypt the encrypted secret file. Alternatively, you can add <code>Disable-AzContextAutosave -Scope Process</code> into your script prior to connecting to ensure it never writes the file even if it&rsquo;s moved to another server, the module is updated, etc.</p><p><img src=/post/protect-passwords-in-powershell-scripts/decrypt-client-secret.png width=1498 height=590 srcset="/post/protect-passwords-in-powershell-scripts/decrypt-client-secret_hu9a8f5d65ab2c2f1bac8722409404f5bd_116037_480x0_resize_box_3.png 480w, /post/protect-passwords-in-powershell-scripts/decrypt-client-secret_hu9a8f5d65ab2c2f1bac8722409404f5bd_116037_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=253 data-flex-basis=609px></p></section><footer class=article-footer><section class=article-tags><a href=/tags/security/>Security</a></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Nov 03, 2022 08:12 -0700</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/azure-app-service-block-ip/><div class=article-details><h2 class=article-title>Block an IP address on Azure App Service</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 Admin Brain Dump</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.13.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#store-the-actual-secrets-in-azure-keyvault>Store the actual secrets in Azure KeyVault</a></li><li><a href=#create-a-service-principal>Create a Service Principal</a></li><li><a href=#create-a-client-secret>Create a Client Secret</a></li><li><a href=#connection-in-powershell-script>Connection in Powershell Script</a></li><li><a href=#whats-the-difference>What&rsquo;s the difference?</a></li><li><a href=#encrypting-the-local-file>Encrypting the local file</a></li><li><a href=#usingdecrypting-the-local-file>Using/decrypting the local file</a></li></ul></li></ul></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>